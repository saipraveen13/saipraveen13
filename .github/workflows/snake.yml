name: Advanced GitHub Snake Game
on:
  schedule:
    - cron: "0 0 * * *"  # Runs daily at midnight UTC
  workflow_dispatch:      # Manual trigger
  push:
    branches:
      - main

jobs:
  generate:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    permissions:
      contents: write

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Create dist directory
        run: mkdir -p dist

      - name: Generate Multiple Snake Animations
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ github.repository_owner }}
          outputs: |
            dist/github-snake.svg
            dist/github-snake-dark.svg?palette=github-dark
            dist/snake-classic.gif?color_snake=green&color_dots=#c6e48b,#7bc96f,#239a3b,#196127
            dist/snake-rainbow.gif?color_snake=red,orange,yellow,green,blue,indigo,violet&color_dots=#ffadad,#ffd6a5,#fdffb6,#caffbf,#9bf6ff,#a0c4ff,#bdb2ff
            dist/snake-fire.gif?color_snake=red,orange,yellow&color_dots=#ff0000,#ff5a00,#ff9a00,#ffce00,#ffe808
            dist/snake-ocean.gif?color_snake=#0077be&color_dots=#bfd6f6,#8dbdff,#64a1f4,#4b91f1,#3c7dd9
            dist/snake-matrix.gif?color_snake=#00ff00&color_dots=#003300,#005500,#007700,#009900

      - name: Create Animated Gallery Page
        run: |
          cat > dist/index.html << 'EOF'
          <!DOCTYPE html>
          <html>
          <head>
            <title>GitHub Snake Animations</title>
            <style>
              body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                background: #0d1117;
                color: #c9d1d9;
                text-align: center;
              }
              h1 {
                color: #58a6ff;
                margin-bottom: 30px;
              }
              .gallery {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
                margin-top: 20px;
              }
              .animation-card {
                background: #161b22;
                border-radius: 8px;
                padding: 15px;
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                transition: transform 0.2s;
              }
              .animation-card:hover {
                transform: translateY(-5px);
              }
              img {
                max-width: 100%;
                border-radius: 4px;
              }
              .caption {
                margin-top: 10px;
                font-weight: 500;
                color: #8b949e;
              }
            </style>
          </head>
          <body>
            <h1>🎮 GitHub Contribution Snake Animations</h1>
            <div class="gallery">
              <div class="animation-card">
                <img src="github-snake.svg" alt="Light Theme Snake">
                <div class="caption">Light Theme SVG</div>
              </div>
              <div class="animation-card">
                <img src="github-snake-dark.svg" alt="Dark Theme Snake">
                <div class="caption">Dark Theme SVG</div>
              </div>
              <div class="animation-card">
                <img src="snake-classic.gif" alt="Classic Green Snake">
                <div class="caption">Classic Green Snake</div>
              </div>
              <div class="animation-card">
                <img src="snake-rainbow.gif" alt="Rainbow Snake">
                <div class="caption">Rainbow Snake</div>
              </div>
              <div class="animation-card">
                <img src="snake-fire.gif" alt="Fire Snake">
                <div class="caption">Fire Snake</div>
              </div>
              <div class="animation-card">
                <img src="snake-ocean.gif" alt="Ocean Snake">
                <div class="caption">Ocean Snake</div>
              </div>
              <div class="animation-card">
                <img src="snake-matrix.gif" alt="Matrix Snake">
                <div class="caption">Matrix Snake</div>
              </div>
            </div>
          </body>
          </html>
          EOF

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist
          publish_branch: output
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
          commit_message: "Update advanced snake animations [skip ci]"

      - name: Update README with Snake Badge
        run: |
          # Add a badge to the README showing the latest animation
          echo "\n## 🐍 GitHub Snake Game\n![GitHub Snake Game](https://github.com/${{ github.repository }}/blob/output/snake-classic.gif)" >> README.md
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add README.md
          git commit -m "Add snake animation badge to README" || echo "No changes to commit"
          git push
